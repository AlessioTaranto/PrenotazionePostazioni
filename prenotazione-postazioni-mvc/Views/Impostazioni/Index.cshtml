@{
    ViewData["Title"] = "Impostazioni";

    ImpostazioniViewModel ViewModel = (ImpostazioniViewModel) Model;
}

@using System.Net
@using prenotazione_postazioni_libs.Models;
@using prenotazione_postazioni_libs.Dto;
@using prenotazione_postazioni_mvc.HttpServices;
@using Newtonsoft.Json;
@inject UtenteHttpService _utenteHttpService;
@inject FestaHttpService _festaHttpService;
@inject CapienzaHttpService _capienzaHttpService;

<link rel="stylesheet" href="css/switch.css">
<div class="settings_container">
  <!-- Sidebar tab (Sinistra) -->
    <div class="nav settings_sidebar_box">
        <div class="settings_sidebar_itemList">
                <a onclick="">Postazioni</a>
                <a onclick="">Festività</a>
                <a>Presenze</a>
                <a>Utenti</a>
        </div>
    </div>
    <!-- Pagina caricata a destra -->
    <div class="settings_content">
        <p>@ViewModel.StateTab</p>
        @{
            if(@ViewModel.StateTab == 0){
                <div class="settings_postazioni">
                    <div class="postazioni_image_container">
                        <img src="img/piantina.png" usemap="#image-map">
                    <map name="image-map">
                        <area alt="Bansky" title="Bansky" href="" coords="3865,1581,3871,936,4701,938,4708,1684" shape="poly">
                        <area alt="OpenSpace_2" title="OpenSpace 2" href="" coords="5097,1172,6381,1334,6323,1645,5052,1464" shape="poly">
                        <area alt="OpenSpace_1" title="OpenSpace 1" href="" coords="5084,529,5039,821,6336,1003,6381,705" shape="poly">
                        <area alt="Sviluppo" title="Sviluppo" href="" coords="4623,2381,4623,2556,4591,2576,4591,4113,5551,4113,5557,2517,5136,2427" shape="poly">
                        <area alt="Assistenza" title="Assistenza" href="" coords="3598,2310,3565,2491,3481,2628,3487,4100,4467,4120,4415,2368,3747,2264,3727,2297" shape="poly">
                        <area alt="Commerciale" title="Commerciale" href="" coords="2587,3251,2580,4120,3449,4107,3443,3075,3021,3095" shape="poly">
                        <area alt="Meeting" title="Meeting" href="" coords="2334,1881,2749,1771,3060,1829,3235,1933,3287,2063,3307,2192,3268,2342,3242,2420,3190,2530,3138,2588,3080,2640,2982,2725,2827,2822,2749,2874,2554,2913,2282,2958,2108,2934,1912,2789,1796,2584,1860,2322,2100,2011" shape="poly">
                        <area alt="Contabilità" title="Contabilità" href="" coords="634,1226,1601,1096,1588,344,647,344" shape="poly">
                    </map>
                    </div>

                    <div class="postazioni_information">
                        <br>
                        <h1>@ViewModel.CapienzaViewModel.GetStanza()</h1>
                        @if (ViewModel.CapienzaViewModel.Stanza != "null")
                        {
                            <div class="postazioni_information_form">
                                <h5>Capienza Normale</h5>
                                <input class="form-control" type="number" id="capienzaNormale" name="capienzaNormale" min="1" max="20" style="width: 100%" @*value="@ViewModel.CapienzaViewModel.GetCapienzaNormale(@ViewModel.CapienzaViewModel.Stanza)"*@>
                                <h5>Capienza Covid</h5>
                                <input class="form-control" type="number" id="capienzaCovid" name="capienzaCovid" min="1" max="20" style="width: 100%" @*value="@ViewModel.CapienzaViewModel.GetCapienzaCovid(@ViewModel.CapienzaViewModel.Stanza)"*@ >
                            </div>
                            <input type="button" class="btn btn-primary bg-darkorange bd-darkorange" id="conferma" value="Conferma">
                        }
                    </div>
                </div>
            }else if(ViewModel.StateTab == 1){
                <div>Test</div>
            }
        }
        
    </div>
</div>


    <!-- Questo script serve per adattare le coordinate dell'ImageMap alla viewport dell'utente -->
<script src="js/jquery.rwdImageMaps.min.js"></script>

<script>
    /*
    * ! <area> è utilizzato unicamente nella Map.
    * Raccoglie il click dalla mappa delle stanze, cambia il valore nel ViewModel e ricarica la pagina.
    */

    $('area').on('click', function () {
    let nameStanza = event.target.title;
    $.ajax({
        type: "POST",
        url: "Impostazioni/SelectRoom",
        data: { "stanza": nameStanza }
    });
    location.window.reload();
    });
</script>